/* ==UserStyle==
@name         Dark ProtonMail by Mew
@description  Dark theme ProtonMail.
@version      0.2.0
@namespace    gitlab.com/vednoc/dark-protonmail
@homepageURL  https://gitlab.com/vednoc/dark-protonmail
@updateURL    https://gitlab.com/vednoc/dark-protonmail/raw/master/protonmail.user.css
@author       vednoc
@license      MIT
@preprocessor stylus

@var text b_radius "Custom border radius" 4px

@var color dark    "Dark color.   " #222222
@var color darker  "Darker color. " #2f2f2f
@var color light   "Light color.  " #d1d1d1
@var color lighter "Lighter color." #c9c9c9
@var color icon    "Icon color.   " #e1e1e1
@var color accent  "Accent color. " #7289da
@var color yellow  "Yellow color. " #f0c674
@var color orange  "Orange color. " #de935f
@var color red     "Red color.    " #a54242
@var color magenta "Magenta color." #b294bb
@var color violet  "Violet color. " #85678f
@var color blue    "Blue color.   " #5f819d
@var color cyan    "Cyan color.   " #5e8d87
@var color green   "Green color.  " #8c9440
@var color white   "White color.  " #ffffff
@var color shadow  "Shadow color. " #00000020

==/UserStyle== */

@-moz-document domain("mail.protonmail.com") {
    :root {
        scrollbar-color: var(--darker) var(--dark);
        --note    : "Dark-ProtonMail v0.2.0";
        --dark    : dark;
        --darker  : darker;
        --light   : light;
        --lighter : lighter;
        --accent  : accent;
        --icon    : icon;
        --shadow  : shadow;
        --yellow  : yellow;
        --orange  : orange;
        --red     : red;
        --magenta : magenta;
        --violet  : violet;
        --blue    : blue;
        --cyan    : cyan;
        --green   : green;
        --white   : white;
        --t       : transparent !important;
        --radius  : b_radius;
    }

    // * Use stylus-lang variables with CSS variables.
    $dark    = var(--dark);
    $darker  = var(--darker);
    $light   = var(--light);
    $lighter = var(--lighter);
    $accent  = var(--accent);
    $icon    = var(--icon);
    $shadow  = var(--shadow);
    $bshadow = var(--box-shadow);
    $yellow  = var(--yellow);
    $orange  = var(--orange);
    $red     = var(--red);
    $magenta = var(--magenta);
    $violet  = var(--violet);
    $blue    = var(--blue);
    $cyan    = var(--cyan);
    $green   = var(--green);
    $white   = var(--white);
    $t       = var(--t);
    $radius  = var(--radius);

    // * Color mixin.
    // ? All colors -> colors: $light, $darker, $dark;
    // ? Only background-color -> colors: 0, 0, $dark;
    colors(x, y, z) {
        if x is a 'call' { color: x !important; }
        if y is a 'call' { border-color: y !important; }
        if z is a 'call' { background-color: z !important; }
    }

    // * Border radius mixin.
    radius() { border-radius: arguments; }

    /* Scrollbars. */
    ::-webkit-scrollbar {
        width: 10px !important;
        &-scrollbar-thumb {
            border: 1px solid $dark;
            background-color: $darker;
            &:hover, &:active { background-color: $accent; }
        }
        &-scrollbar-track { background-color: $dark; }
    }


    body {
        color: var(--lighter);
        background: var(--dark) !important;
    }

    h1, h2, h3, h4, h5, h6, strong {
        color: var(--lighter) !important;
    }

    a, p a {
        text-decoration: none;
        color: var(--accent);
    }

    ::placeholder { colors: $lighter, 0, 0; }

    input {
        color: var(--lighter) !important;
        background: none !important;
    }

    select {
        color: var(--light) !important;
        background-color: var(--darker);
    }

    blockquote {
        border-left-color: var(--accent);
    }

    section {
        border-color: var(--darker) !important;
    }

    kbd {
        color: var(--lighter);
        background-color: var(--dark);
        box-shadow: inset 0 0 0 1px var(--darker);
    }

    .pm_panel {
        color: var(--lighter);
    }
    .pm_panel.alt {
        background-color: transparent;
    }

    // * Login page.
    #login {
        background-image: none !important;
        .pm_panel-login__inner {
            padding: 20px 30px 0;
            radius: $radius;
            colors: 0, $darker, $dark;
            box-shadow: 0 4px 16px -2px $shadow;
            .link { colors: $light, 0, 0; }
            input { colors: $lighter, $darker, 0; }
        }
        [class*="link-signup-button"] {
            radius: $radius;
            transition: 0.15s ease;
            colors: $light, $darker, $darker;
            &:hover { colors: 0, 0, $dark; }
        }
        #pm_footer { colors: $lighter, 0, 0; }
    }

    // * Navbar.
    header[class*="header"] {
        min-height: 50px;
        colors: $lighter, 0, $dark;
        box-shadow: 0 1px 0 0 $darker;
        // Some styles for the logo.
        [class*="-logo"] {
            colors: 0, 0, $t;
            &::before { transition: 0.15s ease; }
            &:hover::before { opacity: 0.8; }
        }
        // Navigation on the right.
        .navigation > {
            li {
                min-height: 51px;
                colors: $lighter, 0, 0;
                &:hover { colors: $light, $accent, 0; }
                &.active { colors: $accent, $accent, $darker; }
            }
        }
        // Sub-nav height reset.
        >[class*="Desktop-container"] {
            height: auto;
            max-height: 51px;
        }
    }

    // * Search bar.
    [class*="searchForm-container"] {
        // Search area.
        .search-form-fieldset {
            radius: $radius;
            colors: $lighter, 0, $dark;
            box-shadow: 0 0 0 1px inset $darker;
        }
        // Dropdown.
        .searchForm-advanced-container {
            radius: $radius;
            colors: 0, 0, $dark;
            box-shadow: 0 0 0 1px $darker, 0 2px 8px 0 $shadow;
            // Fields background reset.
            [class*="searchForm-advanced-"] { colors: $lighter, 0, $t; }
            label, .fa { color: $light; }
            // Inputs and buttons.
            input, button {
                radius: $radius;
                box-shadow: 0 1px 4px 0 inset $shadow;
                colors: 0, $darker, 0;
                &:focus { colors: 0, $blue, 0; }
                &[type="submit"] { &, .fa { colors: $white, $blue, $blue; }}
            }
            // Select menus.
            .pm_select {
                radius: $radius;
                colors: 0, 0, $t;
                box-shadow: 0 0 0 1px inset $darker;
                select {
                    radius: $radius;
                    box-shadow: 0 1px 4px 0 inset $shadow;
                    &:focus { box-shadow: 0 0 0 1px inset $blue; }
                }
            }
        }
    }

    // * Global -> Loader.
    .pm-loader-fullpage { colors: 0, 0, $dark; }

    // * Global -> Loading.
    #pm_loading {
        colors: 0, 0, $dark;
        box-shadow: 0 2px 8px 0 $shadow;
        &::after {
            border: 5px solid $darker;
            border-top-color: $accent;
        }
        svg path { fill: $accent; }
    }

    // * Global -> Storage.
    .storageBar {
        colors: 0, 0, $darker;
        .storageBar-progress { colors: 0, 0, $accent; }
    }

    // * Global -> Checkboxes.
    .customCheckbox-input {
        colors: 0, 0, $dark;
        + .customCheckbox-mask {
            colors: 0, $darker, $dark;
            background-image: none;
        }
        &:checked + .customCheckbox-mask {
            position: relative;
            &::before {
                content: "";
                position: absolute;
                top: 1px; left: 4px;
                width: 6px; height: 10px;
                border-right: 2px solid;
                border-bottom: 2px solid;
                transform: rotate(45deg);
                colors: 0, $light, 0;
            }
        }
    }

    // * Welcome section.
    #pm_view #pm_latest {
        header {
            padding: 8px 24px;
            colors: $light, $darker, 0;
        }
        section {
            padding: 0.5rem;
            margin: 8px;
            radius: $radius;
            span { colors: $lighter, 0, 0; }
            strong { colors: $accent, 0, 0; }
            img { filter: invert(1) hue-rotate(180deg) opacity(0.2); }
        }
    }

    // * Command pallete.
    [class*="commandPalette-container"] {
        radius: $radius;
        colors: 0, 0, $dark;
        box-shadow: 0 2px 8px -2px $shadow;
        // Input section.
        [class*="autocomplete-c"] {
            radius: $radius;
            colors: 0, 0, $dark;
            box-shadow: 0 0 0 1px $darker;
        }
        // Commands.
        [class*="Emails-"] {
            max-height: 150px;
            colors: 0, 0, $t;
            // Items.
            .needsclick {
                transition: 0.15s ease;
                colors: 0, $darker, 0;
                &[aria-selected="false"] { colors: $lighter, 0, $dark; }
                &[aria-selected="true"], &:hover { colors: $light, 0, $darker; }
            }
        }
    }

    // * Sidebar.
    #ptSidebar {
        border-right: 1px solid;
        colors: 0, $darker, $dark;
        height: calc(100% - 51px);
        // box-shadow: 1px 0 0 0 $darker;
        .sidebarApp-item {
            // List items.
            .navigationItem-item {
                transition: 0.15s ease;
                colors: $lighter, 0, 0;
                .navigationItem-counter { color: inherit; }
                .navigationItem-aside { background: none; }
            }
            &:hover:not(.active) > a { colors: $light, 0, $darker; }
            &.active {
                colors: 0, 0, $darker;
                .fa, span { colors: $light, 0, 0; }
            }
        }
        // Compose button.
        .sidebar-btn-compose {
            margin: 16px 0;
            radius: $radius;
            transition: 0.15s ease;
            colors: $lighter, $darker, $t;
            &:hover { colors: $white, $accent, $accent; }
        }
    }


    /* Content area. */
    #conversation-view .frame, #pm_main {
        color: var(--light);
        background-color: var(--dark);
    }


    // * Main -> Content.
    #pm_main {
        #conversation-list-rows {
            // Add stuff.
        }
        // * Content -> Column view.
        #conversation-list-columns {
            colors: 0, $darker, 0;
        }
        // Conversations.
        .conversation {
            colors: 0, $darker, $t;
            &.read { colors: 0, 0, $t; }
            &:hover { colors: 0, 0, $darker; }
            &.marked::before { colors: 0, 0, $darker; }
            // Highlight unread messages.
            &:not(.read) {
                background-image: linear-gradient(
                    to right, $darker -150%, $dark
                ) !important;
            }
        }
    }

    // * Content -> Toolbar.
    .pm_toolbar {
        box-shadow: 0 1px 0 0 $darker;
        .pm_buttons {
            colors: $lighter, 0, 0;
            &.disabled { &, a { opacity: 0.75 !important; }}
            &-child, a, button {
                colors: 0, $darker, $dark;
                &:hover { colors: $light, 0, 0; }
            }
            // TODO: Fix disabled buttons.
            &.paginator > * {
                colors: 0, $darker, $dark;
            }
        }
    }


    /* Button. */
    .pm_button.primary {
        color: var(--lighter);
        border-color: var(--accent);
        background-color: var(--accent);
    }


    /* Dropdown. */
    .pm_dropdown {
        border-color: var(--darker);
        background-color: var(--dark);
    }
    /* Dropdown title. */
    .dropdown-folder-title {
        border-bottom-color: var(--darker);
    }
    /* Dropdown items. */
    .pm_dropdown > button,
    .pm_dropdown > ul > li {
        border-bottom-color: var(--darker);
    }
    .pm_dropdown > button:hover,
    .pm_dropdown > ul > li:hover {
        color: var(--accent) !important;
    }
    /* Links. */
    .pm_dropdown > a,
    .pm_dropdown > button,
    .pm_dropdown > ul > li {
        border-color: var(--darker);
    }
    .pm_dropdown > a:hover,
    .pm_dropdown > button:hover,
    .pm_dropdown > ul > li:hover {
        color: var(--accent) !important;
    }
    /* Text color. */
    .navigationUser-dropdown,
    .dropdown-label-scrollbox-label-text-ellipsis {
        color: var(--light);
    }
    /* Folder container. */
    .scrollbox-container {
        border-color: var(--darker);
        background-image: none;
        background-color: transparent;
    }
    /* Remove weird gradients. */
    .scrollbox-container::before,
    .scrollbox-container::after {
        display: none !important
    }



    /* Message area. */
    #conversation-view .message {
        border-color: var(--darker);
    }
    /* Header. */
    #conversation-view header {
        border-color: var(--darker);
    }
    /* Header details. */
    #conversation-view .message .summary,
    #conversation-view .message .details {
        border-color: var(--darker);
        background-color: transparent;
    }
    /* Date. */
    #conversation-view .message .summary * {
        background-color: transparent !important;
    }
    /* Sent/more tag. */
    .pm_button.more, .pm_tag {
        color: var(--light) !important;
        background-color: var(--darker) !important;
    }
    /* Attachments. */
    #attachmentArea {
        border-color: var(--darker);
        background-color: var(--darker);
    }
    .listAttachments-list .listAttachments-att {
        border-radius: 6px;
        color: var(--light);
        background-color: var(--dark);
    }
    .listAttachments-list .listAttachments-att::after {
        border-right-color: var(--shadow);
    }


    /* Compose. */
    #pm_composer .composer {
        color: var(--lighter);
        background: var(--darker);
    }
    /* Header. */
    .composerHeader-container,
    .composerOptions-container {
        color: var(--lighter);
        background: var(--darker);
    }
    /* Inputs. */
    .composerInputMeta-overlay,
    #pm_composer .composer .row,
    #pm_composer .composer .row select,
    #pm_composer .composer .row input {
        color: var(--lighter);
        border-color: var(--dark);
        background: var(--darker);
    }

    /* Message area. */
    .composer-container,
    .squire-container {
        color: var(--light);
        background: var(--dark);
    }

    /* Footer. */
    #pm_composer .composer footer,
    .squireEditor-loaded footer {
        border-top-color: var(--darker);
        background: var(--darker);
    }
    /* Buttons. */
    #pm_composer .composer footer .pm_button,
    .squireEditor-loaded footer .pm_button {
        color: var(--light);
        border-color: var(--darker);
        background: var(--dark);
    }
    #pm_composer .composer footer .pm_button.primary {
        background: var(--accent);
    }


    /* Squire popover. */
    .squire-popover {
        border-color: var(--darker);
        background: var(--dark);
    }
    /* Toolbar. */
    [class*="squireToolbar"] {
        border-color: var(--dark);
        background: var(--dark);
    }
    /* Icons on event. */
    [class*="squireToolbar-action-options"],
    [class*="squireToolbar-action-color"],
    [class*="squireToolbar-action-"]:hover {
        border-color: var(--dark) !important;
        background-color: var(--dark) !important;
    }


    /* Expiration settings. */
    .alert,
    .alert.alert-info {
        color: var(--lighter);
        background: var(--dark);
    }
    #pm_composer .composer select {
        border-radius: 0;
        color: var(--lighter);
        background: var(--darker);
    }


    /* Modal. */
    .pm_modal .modal-dialog,
    .pm_modal .modal-dialog .modal-content {
        border-color: var(--darker) !important;
        background: var(--dark) !important;
    }
    .pm_modal .modal-details {
        border-color: var(--darker);
    }
    .pm_modal .modal-dialog .modal-footer {
        background: none !important;
    }
    .pm_modal .modal-dialog .modal-content .modal-body {
        box-shadow: inset 0 1px 0 var(--darker), inset 0 -1px 0 var(--darker);
    }
    /* Modal buttons. */
    .pm_modal .modal-dialog .close {
        top: 0;
        right: 0;
        color: var(--light);
        background: none;
    }
    .pm_button {
        color: var(--light);
        border-color: var(--darker);
        background-color: var(--darker);
    }
    .pm_button:hover,
    .pm_button:focus {
        color: var(--lighter);
        background-color: var(--dark);
    }
    .labelModal-container .pm_button.primary {
        color: var(--lighter);
        border-color: var(--accent);
        background-color: var(--accent);
    }
    .dropzone {
        border-color: var(--shadow);
        background: var(--darker);
    }


    /* Contacts. */
    .contactList-table {
        box-shadow: none;
        background: var(--dark);
    }
    /* Header. */
    .pm_table table th {
        border-bottom-color: var(--shadow);
        background: var(--dark);
    }
    /* On event. */
    .contactList-item-activeContact td,
    .contactList-container .pm_table thead th[data-action]:hover {
        background: var(--shadow);
    }
    /* Text color. */
    .pm_table table td {
        color: var(--light);
    }

    /* Locked fields. */
    .contactDetails-fields-locked {
        background: rgba(0,0,0,0.4);
    }
    /* Modal. */
    .contactDetails-fields-locked-notice {
        border-color: var(--darker);
        background: var(--dark);
    }
    /* Inputs. */
    .contactItem-inputs textarea,
    .contactItem-inputs input:not([type=checkbox]) {
        color: var(--light) !important;
        border-color: var(--darker);
        background: var(--dark);
    }


    /* Settings dashboard. */
    .settingsDashboard-plans,
    .settingsDashboard-plans::after,
    .settingsDashboard-plans::before {
        background: none !important;
    }
    .settingsDashboard-overview-section-table-container .overviewSection-container .overviewSection-tbody-billing {
        background: var(--darker);
    }
    /* Purple text. */
    .overviewSection-container [class*="Btn"],
    html.protonmail .text-purple {
        color: var(--accent) !important;
    }
}
